import{d as h}from"../../vendor.3B3OSiTz.js";import{b as g}from"../../blocks.lZcM2_hG.js";const d={debug:!1,inview:!1,options:{charFadeValue:.3,charStagger:.05,intersection:{root:null,rootMargin:"0px",threshold:0}},elements:{main:null,background:null,backgroundFixed:null,backgroundCanvas:null,heading:null,text:null},timelines:{backgroundAnimation:null,backgroundFixed:null,textAnimation:null,headingPin:null},splitTexts:[],async mount(){this.initElements(),this.initIntersectionObserver(),this.reinitializeScrollTriggers(),this._unregisterResize=g.onResize(h(()=>{this.log("Handling resize - refreshing ScrollTriggers"),this.killScrollTriggers(),this.revertSplitTexts(),this.reinitializeScrollTriggers()},200))},initElements(){this.elements.main=this.$one(".block_main"),this.elements.background=this.$one(".block_background"),this.elements.backgroundFixed=this.$one(".background_frame"),this.elements.backgroundCanvas=this.$one(".background_canvas"),this.elements.heading=this.$one(".heading"),this.elements.text=this.$one(".text")},killScrollTriggers(){Object.values(this.timelines).forEach(i=>{i&&i.kill()}),Object.keys(this.timelines).forEach(i=>{this.timelines[i]=null})},revertSplitTexts(){this.splitTexts.forEach(i=>i?.revert?.()),this.splitTexts=[]},reinitializeScrollTriggers(){this.initBackgroundAnimation(),this.initBackgroundFixed(),this.initHeadingPin(),this.initTextAnimation()},initBackgroundAnimation(){typeof gsap<"u"&&typeof ScrollTrigger<"u"&&this.elements.main&&this.elements.backgroundFixed&&(this.log("Initialising background animation ScrollTrigger"),window.matchMedia("(min-width: 1025px)").matches&&(this.timelines.backgroundAnimation=ScrollTrigger.create({trigger:this.block,start:"top top",end:"bottom bottom",scrub:1,markers:this.debug??!1,onUpdate:e=>{const s=e.progress,n=window.matchMedia("(max-width: 1024px)").matches?8:12,t=n-n*s,o=20-20*s,r=`calc(100% - ${t*2}px)`,l=`calc(100vh - ${t*2}px)`;this.elements.backgroundFixed.style.top=`${t}px`,this.elements.backgroundFixed.style.left=`${t}px`,this.elements.backgroundFixed.style.width=r,this.elements.backgroundFixed.style.height=l,this.elements.backgroundFixed.style.borderRadius=`${o}px`}})))},initBackgroundFixed(){typeof gsap<"u"&&typeof ScrollTrigger<"u"&&this.elements.main&&this.elements.backgroundFixed&&(this.log("Initialising background fixed ScrollTrigger"),window.matchMedia("(min-width: 1025px)").matches&&(this.timelines.backgroundFixed=ScrollTrigger.create({trigger:this.block,start:"top top",end:()=>"bottom bottom",pin:this.elements.background,pinSpacing:!1,markers:this.debug??!1})))},initHeadingPin(){typeof gsap<"u"&&typeof ScrollTrigger<"u"&&this.elements.heading&&(this.log("Initialising heading pin ScrollTrigger"),window.matchMedia("(min-width: 1025px)").matches&&(this.timelines.headingPin=ScrollTrigger.create({trigger:this.block,start:"top top",end:()=>"bottom bottom",pin:this.elements.heading,pinSpacing:!1,markers:this.debug??!1})))},initTextAnimation(){if(typeof gsap<"u"&&typeof ScrollTrigger<"u"&&typeof SplitText<"u"&&this.elements.text&&(this.log("Initialising text animation"),window.matchMedia("(min-width: 1025px)").matches)){const e=new SplitText(this.elements.text,{type:"lines, chars",linesClass:"line",charsClass:"char"});this.splitTexts.push(e),gsap.set(e.chars,{opacity:this.options.charFadeValue}),this.timelines.textAnimation=ScrollTrigger.create({trigger:this.block,start:"top top",end:"bottom bottom",scrub:!0,markers:this.debug??!1,onUpdate:s=>{const a=s.progress,n=Math.min(a*1.2,1),t=e.chars.length,o=Math.floor(n*t);e.chars.forEach((r,l)=>{if(l<o)gsap.set(r,{opacity:1});else if(l===o){const c=n*t-o;gsap.set(r,{opacity:this.options.charFadeValue+c*(1-this.options.charFadeValue)})}else gsap.set(r,{opacity:this.options.charFadeValue})})}})}},initIntersectionObserver(){this.checkInitialViewportState(),this.intersectionObserver=new IntersectionObserver(i=>{i.forEach(e=>{const s=this.inview;this.inview=e.isIntersecting,s!==this.inview&&(this.inview?this.log("üëÅÔ∏è Intersection Observer: Scroll text block entered viewport"):this.log("üëÅÔ∏è Intersection Observer: Scroll text block left viewport"))})},this.options.intersection),this.intersectionObserver.observe(this.block)},checkInitialViewportState(){const i=this.block.getBoundingClientRect(),e=i.top<window.innerHeight&&i.bottom>0;this.inview=e,this.log("üìç Initial viewport state:",e?"IN viewport":"OUT of viewport")}};typeof window<"u"&&(window.blockRegistry||(window.blockRegistry={}),window.blockRegistry["scroll-text"]={default:d});
